---
page_title: "Synology Provider"
description: |-
  The Synology provider enables Terraform to manage resources on Synology DiskStation Manager (DSM) systems.
---

# Synology Provider

The Synology provider enables Terraform to manage resources on Synology DiskStation Manager (DSM) systems.

## Authentication

The provider supports multiple authentication methods, prioritizing explicit configuration over environment variables:

1. **Provider Configuration**: Set credentials directly in the provider block
1. **Environment Variables**: Use `SYNOLOGY_HOST`, `SYNOLOGY_USER`, and `SYNOLOGY_PASSWORD`

### Basic Authentication

```hcl
provider "synology" {
  host     = "https://nas.example.com:5001"
  user     = "admin"
  password = "your-password"
}
```

### With Two-Factor Authentication (OTP)


### Using Environment Variables

```hcl
# Provider configuration can be omitted when all 
# required settings are configured via environment variables
provider "synology" {}
```

```bash
# Script to set environment variables
export SYNOLOGY_HOST="https://nas.example.com:5001"
export SYNOLOGY_USER="admin"
export SYNOLOGY_PASSWORD="your-password"
export SYNOLOGY_OTP_SECRET="YOUR_BASE32_TOTP_SECRET" # (optional)
export SYNOLOGY_SKIP_CERT_CHECK="true" # (optional)
export SYNOLOGY_SESSION_CACHE="file" # (optional)
terraform plan
```

## Session Caching

The provider supports session caching to avoid repeated authentication:

- **`auto`** (default): Tries keyring backends, falls back to file/memory
- **`keyring`**: Uses OS keyring (Keychain, WinCred, SecretService, KWallet)
- **`file`**: Stores sessions in a file (requires `session_cache_path`)
- **`memory`**: In-memory cache (lost on provider restart)
- **`off`**: No caching (authenticate every time)

### Example with File-based Cache

```hcl
provider "synology" {
  host               = "https://nas.example.com:5001"
  user               = "admin"
  password           = "your-password"
  session_cache      = "file"
  session_cache_path = "/tmp/terraform-synology-sessions"
}
```

## SSL Certificate Verification

By default, the provider skips SSL certificate verification (useful for self-signed certificates). To enable verification:

```hcl
provider "synology" {
  host            = "https://nas.example.com:5001"
  user            = "admin"
  password        = "your-password"
  skip_cert_check = false
}
```

## Supported Resources

The provider supports managing:

- **Container Projects**: Docker Compose projects and containers
- **Virtual Machines**: Virtualization guests and images
- **File Station**: Files, folders, and ISO images
- **Core System**: Packages, tasks, and events
- **Network Configuration**: Network interfaces and settings

## API Rate Limiting

The provider includes automatic retry logic with exponential backoff for API rate limiting. The default retry limit is 5 attempts.

## Notes

- The provider requires DSM 7.0 or later
- Some resources require specific DSM packages to be installed
- Two-factor authentication requires a valid RFC 4648 base32 TOTP secret (16-32 characters, A-Z and 2-7)
- Session caching significantly reduces authentication overhead for repeated operations


## Example Usage

```terraform
// basic usage
provider "synology" {
  host            = "https://synology.local:5001"
  user            = "tf-user"
  password        = "testing-password" // use it only for testing purposes, use SYNOLOGY_PASSWORD env var to set this value
  skip_cert_check = true               // use it only for testing purposes
}

// OTP with cached session in keyring
provider "synology" {
  host          = "https://synology.local:5001"
  user          = "tf-user"
  password      = "testing-password"
  otp_secret    = "0123456789ABCDEF"
  session_cache = "keyring" # auto | keyring | file | memory | off
  # If you use file mode:
  # session_cache     = "file"
  # session_cache_path = pathexpand("~/.cache/synology-tf")
}

// OTP with cached session in file
provider "synology" {
  host               = "https://synology.local:5001"
  user               = "tf-user"
  password           = "testing-password"
  otp_secret         = "0123456789ABCDEF"
  session_cache      = "file" # auto | keyring | file | memory | off
  session_cache_path = pathexpand("~/.cache/synology-tf")
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `host` (String) Remote Synology URL, e.g. `https://host:5001`. Can be specified with the `SYNOLOGY_HOST` environment variable.
- `otp_secret` (String, Sensitive) OTP secret to use when connecting to Synology DSM. Can be specified with the `SYNOLOGY_OTP_SECRET` environment variable. Format: Valid RFC 4648 base32 TOTP secret: A-Z, 2-7, optional '=', spaces ignored.
- `password` (String, Sensitive) Password to use when connecting to Synology station. Can be specified with the `SYNOLOGY_PASSWORD` environment variable.
- `session_cache` (Attributes) Session cache configuration. Supports caching Synology DSM sessions to reduce login frequency. (see [below for nested schema](#nestedatt--session_cache))
- `skip_cert_check` (Boolean) Whether to skip SSL certificate checks. Can be specified with the `SYNOLOGY_SKIP_CERT_CHECK` environment variable.
- `user` (String) User to connect to Synology station with. Can be specified with the `SYNOLOGY_USER` environment variable.

<a id="nestedatt--session_cache"></a>
### Nested Schema for `session_cache`

Optional:

- `mode` (String) Session cache mode - one of: auto, keyring, file, memory, off. Default: off. Can be set via `SYNOLOGY_SESSION_CACHE` environment variable.
- `path` (String) Directory for file-based session cache when mode = "file". Defaults to OS user cache dir. Can be set via `SYNOLOGY_SESSION_CACHE_PATH` environment variable.